P.register("cvfVersion",function(){return{version:"0.1.0.0-2024-09-13"}});"use strict";
P.when("A","cvfFormDataGenerator","cvf-client-side-counters-util","ready").register("cvf-account-switcher",function(b,h,a){function m(a,c){a.preventDefault();var d=h.retrieveFormData(a.target),l=d.inputData.serializeArray();l.push(e(a.target));b.ajax(window.location.protocol+"//"+window.location.host+d.requestPath,{method:"POST",params:l,success:c,error:f})}function e(a){a=l(a);var b=a.attr("name");b||(b=a.closest(".cvf-account-switcher-sign-out-link").attr("data-name"));var c=a.attr("value");c||
(c=a.closest(".cvf-account-switcher-sign-out-link").attr("data-value"));return{name:b,value:c}}function f(a,c,d){b.trigger(q.error,d)}function d(a){var b=/([^@\s]+)@([a-zA-Z0-9_-]+)(\.[a-zA-Z0-9._-]+)/ig.exec(a);if(null!==b){a=b[1];a=l.trim(a);var c=a.length;if(1!==c){for(var d=a.charAt(0),e=0;e<c-2;e++)d+="*";a=d+=a.charAt(c-1)}a+="@";d=b[2];d=l.trim(d);c=d.length;d=d.charAt(0);for(e=0;e<c-1;e++)d+="*";return a+d+b[3]}b=l.trim(a);a=b.length;if(!(4>=a)){c="";for(d=0;d<a-4;d++)c+="*";b=c+b.substr(a-
4,a-1)}return b}function c(){0===l(".cvf-account-switcher-check-mark:visible").length&&(l(".cvf-account-switcher-check-mark-area").remove(),l(".cvf-account-switcher-profile-details").toggleClass("cvf-account-switcher-profile-details cvf-account-switcher-profile-details-after-account-removed"))}function g(d){var c=new URLSearchParams(window.location.search);c.delete("switch_to_cid");c.has("errorCodes")||c.append("errorCodes","ACCOUNT_SWITCH_FAILED");a.addMetricCount(d);b.trigger(q.error,"automaticAccountSwitchFailure");
window.location.search=c}function t(){if(0!==l(".cvf-switch-to-cid").length)try{a.startMetricTimer(u.latency);var c=l(".cvf-switch-to-cid")[0].getAttribute("value");l(".cvf-automatic-switch-"+c)[0].click();setTimeout(function(){g(u.failureTimeout)},7E3);b.trigger(q.success,"automaticAccountSwitchSuccess");return!0}catch(y){g(u.failureClicking)}finally{a.endMetricTimer(u.latency)}return!1}var l=b.$,q={success:"cvf:account_switcher:success",error:"cvf:account_switcher:error"},u={latency:"AutomaticAccountSwitch_Latency",
failureClicking:"AutomaticAccountSwitch_FailureClicking",failureTimeout:"AutomaticAccountSwitch_FailureTimeout"};(function(){var a=l("#ap-account-switcher-container")[0],b=window.MutationObserver||window.WebKitMutationObserver;if(void 0!==a&&void 0!==b){var d=new b(function(a){for(var b=0;b<a.length;b++)if(null!==a[b].addedNodes){t()||c();d.disconnect();break}});d.observe(a,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}})();(function(){l(".cvf-account-switcher-sign-out-link").live("click",
function(a){m(a,function(e){if(e.redirectUrl)window.location=e.redirectUrl,b.trigger("cvf:account_switcher","redirectOnSignOut");else if(e.succeeded){var f="."+l(a.target).attr("class").match(/cvf-account-switcher-account-group-\w+/g)[0];l(f+"-hide").hide();l(f+"-name").text(l("#cvf-account-switcher-sign-out-replace-text").text());l(f+"-claim").text(d(l(f+"-claim").text()));l(f+"-image").replaceWith(l("\x3cdiv /\x3e").append(l("#cvf-account-switcher-sign-out-replace-image").clone().removeClass("cvf-hidden")).html());
l(f+"-button").removeClass("cvf-widget-btn-val cvf-widget-btn-verify-account-switcher");e=e.switchedAccountId;void 0!==e&&l(".cvf-account-switcher-account-group-"+e+"-check-mark").show();c();window.location.reload()}else b.trigger(q.error,e)})})})();return{automaticAccountSwitch:t}});"use strict";
P.when("A","cvfInputValidatorConfig","ready").register("cvfInputValidator",function(b,h){return{getValidationResult:function(a){var m=!0,e=[],f=[];h.forEach(function(d){var c=b.$(d.invalidFieldAlertSelector),g=b.$(d.emptyFieldAlertSelector);d=a.find(d.inputSelector);d[0].required&&!d.val().trim()?(m=!1,0<g.length?(e.push(g),0<c.length&&f.push(c)):0<c.length&&e.push(c)):(0<g.length&&f.push(g),g=d[0].checkValidity&&!d[0].checkValidity(),m=m&&!g,c.length&&(g?e.push(c):f.push(c)))});return{isValid:m,
activeAlerts:e,inactiveAlerts:f}}}});"use strict";P.when("A","ready").register("cvfInputValidatorConfig",function(b){return[{inputSelector:".cvf-widget-input-code",invalidFieldAlertSelector:".cvf-widget-invalid-code-alert",emptyFieldAlertSelector:".cvf-widget-empty-field-alert"}]});P.register("a-sheet-wrapper",function(){return null});"use strict";
P.when("A","cvfFormDataGenerator","ready").register("cvfCaptcha",function(b,h){b=b.$;0===b(".cvf-widget-input-captcha").children("input").length?(b(".cvf-widget-input-captcha").attr("autocapitalize","off"),b(".cvf-widget-input-captcha").attr("autocorrect","off")):(b(".cvf-widget-input-captcha").children("input").attr("autocapitalize","off"),b(".cvf-widget-input-captcha").children("input").attr("autocorrect","off"))});"use strict";
P.when("A").register("cvf-client-side-counters-util",function(b){function h(a,b){var e=window.ue;e&&"function"===typeof e.count&&(b||(b=(e.count(a)||0)+1),e.count(a,b))}return{incrementCounter:function(a){h(a)},insertCounter:h,addMetricCount:function(a){window.ue&&"function"===typeof window.ue.count&&window.ue.count(a,1)},startMetricTimer:function(a){window.uet&&"function"===typeof window.uet&&window.uet("bb",a,{wb:1})},endMetricTimer:function(a){window.uex&&"function"===typeof window.uex&&window.uex("ld",
a,{wb:1})}}});
P.when("A","3p-promise","a-alert","codeResendTimer","cvf-client-side-counters-util","sms-retriever-handler","web-otp-handler","ready").execute("client-sms-request-controller",function(b,h,a,m,e,f,d){function c(){b.show("#cvf-otp-autoread-progress");e.incrementCounter(v.SHOW_AUTOREAD_WIDGET);var a=t();k.delegate("#cvf-input-code","input",function(){g(a)})}function g(a){clearTimeout(a);b.hide("#cvf-otp-autoread-progress");a=n("#cvf-auto-read-status");var c=this.abortController;c&&c.abort();a.val()!==
w.AUTOREAD_TIMEOUT&&a.val()!==w.AUTOREAD_SUCCESS&&(e.incrementCounter(v.CANCEL_AUTOREAD_WIDGET),a.val(w.AUTOREAD_CANCELLED))}function t(){return setTimeout(function(){l()},3E4)}function l(){var c=n("#cvf-auto-read-status");b.hide("#cvf-otp-autoread-progress");e.incrementCounter(v.AUTOREAD_WIDGET_TIMEOUT);c.val(w.AUTOREAD_TIMEOUT);a("#cvf-otp-autoread-timeout").show();(c=this.abortController)&&c.abort("Auto-read OTP timeout")}function q(a){r=a;a=n("#cvf-auto-read-status");z&&a.val()!==w.AUTOREAD_TIMEOUT&&
a.val()!==w.AUTOREAD_CANCELLED&&(a=r,n("#cvf-auto-read-status").val(w.AUTOREAD_SUCCESS),n("#cvf-input-code").val(a).trigger("input"),b.show("#cvf-otp-autoread-success"),k.submit())}function u(a){m.createTimer(Number(a.timeRemaining),n("#resend-timer-message-id").val(),n("#resend-timer-complete-id").val().replace(/"/g,""),"timer","timer",!1);a=n("#wait-resend-auto-read");a.submit(function(a){a.preventDefault()});n(".wait-one-minute-continue").click(function(){x.location.reload()});a.removeClass("aok-hidden");
k.addClass("aok-hidden")}function B(){a("#otp-request-failed-alert").show();n("#cvf-input-code").attr("disabled","disabled").addClass("a-form-disabled");n("#cvf-submit-otp-button").addClass("a-button-disabled");n("#cvf-resend-link").unbind().click(function(){x.location.reload()})}function y(a){b.get(a,{success:function(a){if(a.wait)e.incrementCounter(v.WAIT_RESEND),u(a);else if(a.redirect)e.incrementCounter(v.REDIRECT),x.location.replace(a.redirect);else if(a=a.smsFormat){if(e.incrementCounter(v.RECEIVED_FORMAT+
":"+a),"androidAutoReadSmsWithAppHash"===a||"androidAutoReadSmsWithWebOtp"===a)z=!0,c(),r&&q(r)}else e.incrementCounter(v.FORMAT_NOT_RECEIVED),console.error("Failed to receive sms format")},error:function(a,b,c){e.incrementCounter(v.AJAX_SMS_REQUEST_FAILED+":"+c);B();console.error("Ajax request failed",c)}})}var n=b.$,x=this;f=[f,d];var w=Object.freeze({AUTOREAD_SUCCESS:"autoreadWidgetSuccess",AUTOREAD_CANCELLED:"autoreadWidgetCancelled",AUTOREAD_TIMEOUT:"autoreadWidgetTimeout"}),v=Object.freeze({SHOW_AUTOREAD_WIDGET:"OTPAutoReadShowWidget",
CANCEL_AUTOREAD_WIDGET:"OTPAutoReadCanceWidgetForManualInput",AUTOREAD_WIDGET_TIMEOUT:"OTPAutoReadWidgetTimeout",RECEIVED_FORMAT:"OTPAutoReadReceivedFormat",FORMAT_NOT_RECEIVED:"OTPAutoReadFormatNotReceived",REDIRECT:"OTPAutoReadClientRedirect",AJAX_SMS_REQUEST_FAILED:"OTPAutoReadAjaxSmsRequestFailed",WAIT_RESEND:"OTPAutoReadWaitResend"});if((d=b.state("autoReadAttrs"))&&d.isClientDrivenOtpSendingEnabled){var A=d.arbParam;if(A){var k=n("#verification-code-form");if(0!==k.length){var r=null,z=!1;b.capabilities.android?
(f=f.map(function(a){return a.isEnabled().then(function(b){return b?a.registerListener(q).then(function(a){return a}):{}})}),h.all(f).then(function(a){var b=[],c={};a.forEach(function(a){a.handlerCapability&&b.push(a.handlerCapability);a.handlerQueryParams&&n.extend(c,a.handlerQueryParams)});a={arb:A,mode:"page_ajax",sendClientDrivenOtp:!0,capabilities:b.join()};n.extend(a,c);a=x.location.origin+"/ap/cvf/request?"+n.param(a);y(a)})):(h=x.location.origin+"/ap/cvf/request?"+n.param({arb:A,mode:"page_ajax",
sendClientDrivenOtp:!0}),y(h))}}}});"use strict";
P.when("A","ready").register("codeResendTimer",function(b){function h(h,e,f,d,c,g){var m=(new Date).getTime();g&&(clearInterval(a),window.localStorage.removeItem("icaCVFTimeId"));a=setInterval(function(){var l=(new Date).getTime()-m,q=h-l;g&&window.localStorage.setItem("icaCVFTimeId",q);0>=q?(clearInterval(a),g&&window.localStorage.removeItem("icaCVFTimeId"),g?(b.$("#"+d).hide(),b.$("#"+c).show()):b.$("#"+c).html(f)):(l=e.split(" +timeleft+ "),g?(q=(new Date(q)).toISOString().slice(14,19),l=l[0].split('"').join("")+
q+l[1].split('"').join("")):l=l[0].split('"').join("")+Math.floor(q/1E3)+l[1].split('"').join(""),b.$("#"+d).html(l))},100)}var a;return{createTimer:function(a,b,f,d,c,g){return new h(a,b,f,d,c,g)},showTimer:function(){b.$("#cvf-resend-link").hide();b.$("#cvf-resend-text").removeClass("cvf-hidden")}}});"use strict";
P.when("A","cvfFormDataGenerator","ready").execute(function(b,h){var a=b.$;a(".cvf-widget-btn-val").click(function(b){var e=a(b.target).closest(".cvf-widget-form");b=h.getNameValue(a(b.target));e.append('\x3cinput type\x3d"hidden" name\x3d"'+b.name+'" value\x3d"'+b.value+'"\x3e').submit()})});"use strict";
P.when("A","cvfVersion","cvfFormDataGenerator","cvfInputValidator","ready").register("cvf",function(b,h,a,m){function e(e){function l(a){"string"===typeof k.options.widgetMetricsScope&&"function"===typeof window.uet&&window.uex("ld",k.options.widgetMetricsScope,{wb:1});k.options.spinnerTarget&&k.options.spinnerTarget.hide();if(a.hasOwnProperty("error"))b.trigger(r.error,a.error);else if(a.redirectUrl)window.location=a.redirectUrl;else if(a.redirect){b.trigger(r.success,a.token,a.status,a.redirect);
if(k.options.showICALoadingAnimationOnSuccess){var c=d("#in-context-auth-loading-animation").prop("outerHTML");p.html(c)}k.options.autoDestroy?k.destroy():(d(".cvf-widget-alert").hide(),a.status?d(".cvf-widget-status-success").show():d(".cvf-widget-status-error").show(),A());b.trigger("cvf:verification:complete",a.status);p.find(".cvf-widget-btn").unbind("click",f);p.find(".cvf-widget-btn-val").unbind("click",f);b.off(r.success);b.off(r.error);b.off(r.content)}else p.html(a.replace(/<form/g,"\x3cdiv").replace(/<\/form/g,
"\x3c/div")),c=d(".cvf-widget-form-keep").clone().empty(),a=d(".cvf-widget-form-keep").children().clone(!0,!0),c=(new String(c.prop("outerHTML"))).replace(/<div/g,"\x3cform").replace(/<\/div/g,"\x3c/form"),d(".cvf-widget-form-keep").replaceWith(c),d(".cvf-widget-form-keep").html(a),x(),b.trigger(r.content)}function f(c,e,f){c.preventDefault();d(".cvf-widget-alert").hide();k.options.spinnerTarget&&k.options.spinnerTarget.show();var g=a.retrieveFormData(c.target,f);if(B()){if(k.options.showICAClaimUIOnClickChangeLink){k.options.showICAClaimUIOnClickChangeLink=
!1;k.options.spinnerTarget&&k.options.spinnerTarget.hide();c=d("#change-signin-claim-link-id").val();b.ajax(c,{method:"GET",dataType:"html",success:function(a){b.trigger("in-context-auth-content-update-event",a)},error:function(){d("#cvf-change-contact-link").hide();console.error("AJAX request to /ax/claim/ica failed.",this.error)}});return}if(f)p.find(".cvf-widget-input").removeClass("cvf-widget-input-error");else if(f=m.getValidationResult(g.form),f.inactiveAlerts.forEach(function(a){a.hide()}),
f.activeAlerts.forEach(function(a){a.show()}),f.isValid)p.find(".cvf-widget-input").removeClass("cvf-widget-input-error");else{k.options.spinnerTarget&&k.options.spinnerTarget.hide();p.find(".cvf-widget-input").addClass("cvf-widget-input-error");y();n();return}}f=g.inputData.serializeArray();e&&f.push(a.getNameValue(c.target));b.ajax(z+g.requestPath,{method:"POST",params:f,success:l,error:v})}function t(a){13===a.keyCode&&f(a)}function B(){return 0<p.find('input[name\x3d"is_in_context_auth"]').length}
function y(){p.find('input[name\x3d"code"]').focus()}function n(){p.find('input[name\x3d"code"]').keypress(t)}function x(){p.find(".cvf-widget-btn").click(function(a){f(a,!1)});p.find(".cvf-widget-btn-val").click(function(a){f(a,!0)});B()||y();n();p.find(".cvf-widget-v2-link-resend").click(function(a){f(a,!1,!0)});p.find("#cvf-signin-with-password").click(function(a){a.preventDefault();p.find("#cvf-signin-with-password-instead-form").submit()});p.find(".cvf-widget-v2-change-contact-link").click(function(a){k.options.showICAClaimUIOnClickChangeLink=
!0;f(a,!1)})}function w(a){return function(c,d,e){"timeout"!==d||3<=C?b.trigger(r.error,e):b.delay(a,10*C++)}}function v(a,c,d){k.options.spinnerTarget&&k.options.spinnerTarget.hide();b.trigger(r.error,d)}function A(){d.each(p.find("input"),function(a,b){a=d(b);a.attr("disabled","disabled");a.hasClass("a-input-text")?a.addClass("a-form-disabled"):a.hasClass("a-button-input")?a.closest(".a-button").addClass("a-button-disabled"):a.closest(".a-input-text-wrapper").length&&a.closest(".a-input-text-wrapper").addClass("a-form-disabled")});
d.each(p.find("a"),function(a,b){a=d(b);a.hasClass("cvf-widget-link-disable-target")&&a.addClass("cvf-link-disabled")})}var k=this;g++;var r={success:"cvf:"+g+":success",error:"cvf:"+g+":error",content:"cvf:"+g+":content"};k.options={};d.extend(k.options,c,e);(function(a){if(1!==d(a.target).length)throw Error("The CVF widget requires a unique element.");if(!d.isFunction(a.onSuccess))throw Error("The CVF widget requires a success callback function.");if(!d.isFunction(a.onError))throw Error("The CVF widget requires an error callback function.");
})(k.options);var z=k.options.server,p=d(k.options.target);b.on(r.success,k.options.onSuccess);b.on(r.error,k.options.onError);b.on(r.content,k.options.onContent);k.start=function(){var a=z+"/ap/cvf/request.embed",c=k.options.requestToken,e=k.options.requestArbToken,f=k.options.associationHandle,g=k.options.language,m=0===d.trim(c).length,t=0===d.trim(e).length;if(m&&t)throw Error("The CVF widget requires a request token or arb token.");m=0!==d.trim(f).length;var q=0!==d.trim(g).length,u={};t?u.requestToken=
c:u.arb=e;u.CVFVersion=h.version;u.AUIVersion=P.AUI_BUILD_DATE;q&&(u.language=g);m&&(u["openid.assoc_handle"]=f);"string"===typeof k.options.widgetMetricsScope&&"function"===typeof window.uet&&window.uet("bb",k.options.widgetMetricsScope,{wb:1});b.ajax(a,{method:"GET",params:u,success:l,error:w(k.start)})};k.destroy=function(){p.html("")};x();var C=0;k.options.autoStart&&k.start()}function f(a){return new e(a)}var d=b.$,c={server:"",target:void 0,requestToken:void 0,requestArbToken:void 0,onSuccess:void 0,
onError:void 0,onContent:function(){},spinnerTarget:void 0,autoStart:!0,autoDestroy:!0,widgetMetricsScope:void 0,associationHandle:void 0,language:void 0,showICALoadingAnimationOnSuccess:!1,showICAClaimUIOnClickChangeLink:!1},g=0;b.on("cvf:verification:request",function(a){var c=d("#"+a),e=c.data("token"),g=c.data("spinnerId");g=d("#"+g);f({target:c,spinnerTarget:g,requestToken:e,onSuccess:function(c,d,e){b.trigger("cvf:verification:complete:"+a,c,d,e)},onError:function(c){b.trigger("cvf:verification:error:"+
a,c)},autoStart:!0,autoDestroy:!1})});return{create:f}});"use strict";
P.when("A","ready").register("cvfFormDataGenerator",function(b){var h=b.$;return{retrieveFormData:function(a,b){a=h(a).closest(".cvf-widget-form");b&&(a=h(".cvf-widget-form-resend"));return{requestPath:a.data("use-only-form-action")?a.attr("action"):"/ap/cvf/"+a.attr("action")+".embed",inputData:a.find(".cvf-widget-input,.cvf-widget-hidden-fields,.cvf-widget-input :input"),form:a}},getNameValue:function(a){a=h(a);var b=a.attr("name");b||(b=a.closest(".cvf-widget-btn-val").attr("data-name"));var e=
a.attr("value");e||(e=a.closest(".cvf-widget-btn-val").attr("data-value"));return{name:b,value:e}}}});"use strict";
P.when("A","cvf","ready").execute(function(b,h){var a=b.$;a(document).ready(function(){function b(a,b,c){window.location=c;console.log("Client Side: "+a)}function e(a){console.log(a)}var f=a(".cvf-widget-spinner"),d=a("#cvf-widget-content");if(1===d.length){var c=a('[name\x3d"requestToken"]').first().attr("value");h.create({target:d,spinnerTarget:f,requestToken:c,onSuccess:b,onError:e,autoStart:!1})}})});"use strict";
P.when("A","ready").register("phoneFormField",function(b){function h(){a:{for(var b=a("select[name\x3d'cvf_phone_cc']").val()||"",d=0;d<e.length;d++){var c=e[d];if(b.toUpperCase()===c){a("#mobileClaimDisclosureMessageV2").removeClass("a-hidden aok-hidden").show();a("#mobileClaimDisclosureMessage").addClass("aok-hidden").hide();a("#mobileClaimDisclosureMessageRelaxed").addClass("aok-hidden").hide();break a}}for(d=0;d<m.length;d++)if(c=m[d],b.toUpperCase()===c){a("#mobileClaimDisclosureMessage").removeClass("a-hidden aok-hidden").show();
a("#mobileClaimDisclosureMessageV2").addClass("aok-hidden").hide();a("#mobileClaimDisclosureMessageRelaxed").addClass("aok-hidden").hide();break a}a("#mobileClaimDisclosureMessageRelaxed").removeClass("a-hidden aok-hidden").show();a("#mobileClaimDisclosureMessage").addClass("aok-hidden").hide();a("#mobileClaimDisclosureMessageV2").addClass("aok-hidden").hide()}}var a=b.$,m=["CA","FR"],e=["US"];0<a("select[name\x3d'cvf_phone_cc']").length&&0<a("#mobileClaimDisclosureMessage").length&&0<a("#mobileClaimDisclosureMessageRelaxed").length&&
0<a("#mobileClaimDisclosureMessageV2").length&&(h(),a("select[name\x3d'cvf_phone_cc']").change(h))});"use strict";P.when("A","ready").execute(function(b){function h(a){var b=a.value.match(m);b&&1===b.length?a.setAttribute("aria-invalid","false"):a.setAttribute("aria-invalid","true")}function a(a){a.addEventListener("change",function(b){h(a)})}var m=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;b=b.$("input[id\x3d'cvfEmail']");b.length&&(a(b[0]),h(b[0]))});"use strict";
P.when("A").execute(function(b){b.declarative("auth-popup","click",function(b){var a=b.data;b=b.$target.closest("a")[0];(a=window.open(b.href,b.target,a.windowOptions))&&a.focus()})});P.register("android-sms-otp-parser",function(){return{parseOtpCode:function(b){if(b&&(b=b.match(/(([\s\S]*[^0-9])|(^))([0-9]{4,6})[^0-9][\s\S]*[a-zA-Z0-9+\\\/]{11}/)||[],0<b.length))return b[4]}}});
P.when("A","mobile-auth-platform","3p-promise","android-sms-otp-parser","cvf-client-side-counters-util","ready").register("sms-retriever-handler",function(b,h,a,m,e){function f(a){(g=a.isSupported)?e.incrementCounter(c.ENABLED):e.incrementCounter(c.DISABLED);t={appHash:a.appHash}}function d(){return new a(function(a){t?a(t):h.isSmsRetrieverEnabled(function(b){f(b);a(t)})})}var c=Object.freeze({ENABLED:"SmsRetrieverEnabled",DISABLED:"SmsRetrieverDisabled",SMS_LISTENER_FAILED:"SmsRetrieverListenerFailedToRegister",
RECEIVED_INVALID_SMS:"SmsRetrieverListenerReceivedInvalidSms",RECEIVED_VALID_SMS:"SmsRetrieverListenerReceivedValidSms"}),g=null,t=null;return{isEnabled:function(){return new a(function(a){null!==g?a(g):h.isSmsRetrieverEnabled(function(b){f(b);a(g)})})},registerListener:function(b){return new a(function(a){h.registerMAPSmsReceiver(function(a){a.isRegistered?(a=m.parseOtpCode(a.sms))?(e.incrementCounter(c.RECEIVED_VALID_SMS),b(a)):e.incrementCounter(c.RECEIVED_INVALID_SMS):e.incrementCounter(c.SMS_LISTENER_FAILED)});
d().then(function(b){g?a({handlerCapability:"smsRetriever",handlerQueryParams:b}):a({})})})}}});"use strict";
P.when("A","a-spinner","ready").execute(function(b,h){function a(){f(".otp-input-box").attr("disabled","disabled");f("input[name\x3d'code']").val(m());(null!==f(".otp-input-box-container").data("isembed")?f(".otp-input-box-container").data("isembed"):1)?f(".cvf-widget-btn-verify").click():(b.capabilities.isAmazonApp||h("#otp-input-spinner").show(),f("#verification-code-form").submit())}function m(){var a="";f("input[name^\x3dotc]").each(function(b){a+=f(this).val()});return a}function e(){f(".cvf-widget-alert").is(":visible")&&
(f(".otp-input-box").removeClass("otp-input-box-alert"),f(".cvf-widget-alert").hide())}var f=b.$,d=/^\d+$/;b.declarative("otp-inputbox-handler","focusin",function(a){a=a.$target;a.is(".otp-input-box")&&(a.attr("name").match("otc-1")||""===a.prev().val()&&a.prev().focus())});b.declarative("otp-inputbox-handler","keyup",function(b){var c=b.$event;b=b.$target;b.is(".otp-input-box")&&(c=c.which||c.keyCode,-1===[16,9,224,18,17].indexOf(c))&&(-1!==[8,37,46].indexOf(c)?b.prev()&&!b.attr("name").match("otc-1")&&
(b.val(""),b.prev().select()):d.test(b.val())?b.attr("name").match("otc-6")?a():b.next()&&(e(),b.next().select()):b.val(""))});f(".otp-input-box").live("input",function(b){b=f(b.target);var c=b.val();e();if(1!==c.length)for(var d=0;d<c.length;d++){b.val(c.charAt(d));if(b.attr("name").match("otc-6")){a();break}b=b.next();b.focus()}});b.declarative("otp-inputbox-handler","click",function(){f("input[name^\x3dotc]").each(function(a){""===f(this).val()&&f(this).focus()})})});
P.when("A","ready").execute(function(b){function h(){var b=parseInt(a("input#clickCountHidden").val());0===parseInt(a("input#clickCountHidden").val())&&a("#clickCreationTimeHidden").val(Date.now());a("input#clickCountHidden").val(b+1);var e=parseInt(a("input#clickCreationTimeHidden").val());e=Date.now()-e;4<=b||15E3<e?(a("#defaultAlert").css("display","none"),a("#notReceivedWarningAlert").css("display","none"),a("#notReceivedErrorAlert").css("display","block")):(a("#defaultAlert").css("display","none"),
a("#notReceivedWarningAlert").css("display","block"),a("#notReceivedErrorAlert").css("display","none"))}var a=b.$;b.declarative("incoming-sms-action","click",function(b){b=a("#marketplaceIdHidden").val();var e=a("#amazonAPIAjaxEndpointHidden").val(),f=a("#codeHandleHidden").val(),d=document.querySelector('meta[name\x3d"encrypted-slate-token"]');d=d?d.content:d;a.ajax({url:function(a,b,d){return"https://{apiEndpoint}/custom/authxprivateapicontracts/marketplaces/{marketplaceId}/challenge/two-way-sms/otp-code-transaction-status?codeHandle\x3d{codeHandle}".replaceAll("{apiEndpoint}",
a).replaceAll("{marketplaceId}",b).replaceAll("{codeHandle}",d)}(e,b,f),type:"GET",headers:{"Accept-Language":"en-US",Accept:'application/vnd.com.amazon.api+json; type\x3d"aapi.authxprivateapicontracts.custom.authx.two-way-sms.otp-code-transaction-status.response/v1"',"X-API-CSRF-TOKEN":a("#aapiCsrfTokenHidden").val(),"x-amzn-encrypted-slate-token":d},xhrFields:{withCredentials:!0},success:function(b){b=b.entity.status;"IncomingSMSValidated"===b||"OutgoingNotificationSent"===b?a("#two-way-sms-one").submit():
h()},error:function(a){h()}})})});
P.when("A","3p-promise","cvf-client-side-counters-util","ready").register("web-otp-handler",function(b,h,a){function m(a){return a?Object.values(f).some(function(b){return a.includes(b)}):!1}function e(){return new h(function(e){null===c&&((c=!(b.capabilities.isAmazonApp||m(g))&&"OTPCredential"in window)?a.incrementCounter(d.WEB_OTP_ENABLED):a.incrementCounter(d.WEB_OTP_DISABLED));e(c)})}var f=Object.freeze({AMZN_APP_ID_COOKIE_NAME:"amzn-app-id",AMZN_APP_CTXT_COOKIE_NAME:"amzn-app-ctxt"}),d=Object.freeze({WEB_OTP_ENABLED:"WebOtpEnabled",
WEB_OTP_DISABLED:"WebOtpDisabled",WEB_OTP_SMS_LISTENER_FAILED:"WebOtpListenerFailedToRegister",WEB_OTP_RECEIVED_INVALID_SMS:"WebOtpListenerReceivedInvalidSms",WEB_OTP_RECEIVED_VALID_SMS:"WebOtpListenerReceivedValidSms"}),c=null,g=document.cookie;return{isEnabled:e,registerListener:function(b){return new h(function(f){e().then(function(c){c?(window.abortController=new AbortController,navigator.credentials.get({otp:{transport:["sms"]},signal:window.abortController.signal}).then(function(c){(c=c.code)?
(a.incrementCounter(d.WEB_OTP_RECEIVED_VALID_SMS),b(c)):a.incrementCounter(d.WEB_OTP_RECEIVED_INVALID_SMS)}).catch(function(b){a.incrementCounter(d.WEB_OTP_RECEIVED_INVALID_SMS);console.error(b)})):a.incrementCounter(d.WEB_OTP_SMS_LISTENER_FAILED)});c?f({handlerCapability:"webOtp",handlerQueryParams:{}}):f({})})},abortController:window.abortController}});P.when("A","ready").execute(function(b){b.declarative("secondary-channel-link-click","click",function(){b.$(".cvf-widget-form-secondary-channel").submit()})});